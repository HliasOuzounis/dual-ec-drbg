\section{Dual EC DRBG}

\subsection{The Dual EC DRBG algorithm}

The Dual EC DRBG algorithm was a pseudo-random bit generator that was included in the NIST SP 800-90 standard \cite{nist-sp800-90}. It utilizes elliptic curve cryptography to generate the random bits as well as updating the seed of the generator. This algorithm was designed in part by the National Security Agency (NSA) of the United States as a secure PRNG. It is built on an elliptic curve over a finite field, with parameters $\alpha, \beta, \mathbb{F}_p$ selected by the designers. The size of the resulting elliptic curve group is massive, in the order of $2^{256}$ for the smallest of the three curves proposed.
\\

\img[Diagram of the Dual EC DRBG algorithm]{images/dual-ec-drbg-diagram.png}{8}{dual-ec-drbg}

In Figure \ref{fig:dual-ec-drbg} the basic structure of the Dual EC DRBG algorithm is shown. The algorithm consists can be split in two parts, the generating and the reseeding part. 
\\

Starting from a seed $s_i$, the algorithm performs a scalar-Point multiplication with a specified point P, $s_iP$. Afterwards, the x coordinate of the resulting point is kept while the y coordinate is discarded, 
\begin{gather}
    r_i = {(s_iP)}_x    
\end{gather}
Afterwards, this new scalar value is used in another scalar-Point multiplication with another selected point on the curve and the x coordinate is kept again.
\begin{gather}
    A = r_iQ \\
    t_i = A_{x}
\end{gather}
Finally, form the resulting x coordinate, the output bits are generated by removing the 16 most significant bits of $t_i$.
\begin{gather}
    o_i = t_i \mod 2^{bitlen - 16}
\end{gather}
\\

\noindent
As for the new seed, it is calculated by performing a third scalar-Point multiplication between $r_i$ and $P$ and keeping the x coordinate.
\begin{gather}
    s_{i+1} = {(r_iP)}_x
\end{gather}

For the values of the parameters of the elliptic curve used in the algorithm, the NIST SP 800-90 specifies them as follows for the curve P-256 \cite{nist-sp800-90}:
\begin{align*}
    p &= 115792089210356248762697446949407573530086143415290314195533631308867097853951 \\
    \alpha &= -3 \\
    \beta &= 5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b_{16} \\
\end{align*}
This elliptic curve creates a group of order 
\begin{gather*}
    n = 115792089210356248762697446949407573529996955224135760342422259061068512044369 \label{eq:order}
\end{gather*} 
well above the required size to be secure to brute force attacks.
\\

\noindent
As for the points $P$ and $Q$ used in the algorithm, the NIST specifies them as \cite{nist-sp800-90}:
\begin{align*}
    P_x &= 6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296_{16}\\
    P_y &= 4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5_{16}\\
    Q_x &= c97445f4 5cdef9f0 d3e05e1e 585fc297 235b82b5 be8ff3ef ca67c598 52018192_{16}\\
    Q_y &= b28ef557 ba31dfcb dd21ac46 e2a91e3c 304f44cb 87058ada 2cb81515 1e610046_{16}
\end{align*}

\subsection{Controversy regarding the Dual EC DRBG algorithm}

In theory the algorithm is effective in providing secure and random bits at the output as the parameters are sufficiently large and create prime-sized groups that are safe from some other known methods that exploit properties of elliptic curves \cite{secure-randomness}. However, when it was first announced, there were some concerns over the selection of the $P$ and $Q$ points \cite{green-2013-dualec-flaws}. It is customary for algorithm designers to provide some explanation of their derivation of the values used, but none were provided for the Dual EC DRBG algorithm. They are often generated by a verifiable seed or by some other method involving mathematical constants, like the digits of pi. This created some suspicion that the NSA had maliciously selected the points to create a backdoor in the algorithm. This was further fueled by the fact that the NSA had previously been caught inserting backdoors in other cryptographic algorithms, like the DES encryption standard, and that they required the use of these specific points. Any other points were deemed insecure by the NSA, but no explanation was given as to why.
\\

Not long after the algorithm was announced, the cryptographic community voiced their concerns over the algorithm and the NSA's involvement in its design. Firstly, it was criticized for being slower than other know algorithms at the time \cite{green-2013-dualec-flaws}, but the majority of the criticism was targeted on the lack of transparency in the choices of $P$ and $Q$. As many cryptographic experts pointed out \cite{comments-on-dual-ec-drbg} \cite{ecdsa}, by selecting $P$ and $Q$ in a specific way, the NSA could have access to the current random seed of the generator just by looking at the outputs. This would allow them to predict the output of the generator and thus break the security of the algorithm.

\subsection{The Dual EC DRBG backdoor}
How could someone select $P$ and $Q$ in such a way that it would be possible to predict the value of the new seed $s_{i + 1}$ from the output $o_i$? The answer lies in the generator point $P$. As the order of $P$ is prime, and equal to n \eqref{eq:order}, it must mean that the group generated by $P$ is the entire group of the curve. This means that for any point $Q$ on the curve, there exists a scalar $k$ such that $Q = kP$. Calculating the value of $k$ just by knowing $Q$ and $P$ is not realistic as it would require to solve the discrete logarithm problem, which, as has been stated before, is computationally infeasible. If NSA had chosen $Q$ by selecting a value for $k$, it would be possible, almost trivial, to find an $e$ such that $P = eQ$ \cite{backdoor}.
\begin{align}
    Q &= kP \nonumber \\
    Q &= k(eQ) \nonumber \\
    1 &= ke \mod n \nonumber \\
    e &= k^{-1} \mod n
\end{align}
With this value of $e$, an attacker could reverse the algorithm and retrieve the value of the seed $s_{i + 1}$ from $o_i$ by skipping the intermediate value $r_i$ which is computationally impossible to find.
\begin{align}
    s_{i + 1} &= {(r_iP)}_x \nonumber \\
    s_{i + 1} &= {(r_i(eQ))}_x \nonumber \\
    s_{i + 1} &= {(e(r_iQ))}_x \nonumber \\
    s_{i + 1} &= {(eA)}_x 
\end{align}

Recall however, that the final step before the output is truncating the first 16 bits of $t_i$, meaning the attacker, by knowing the output $o_i$ cannot be certain of the value of $t_i$ and thus the next seed $s_{i + 1}$. Nonetheless, the size of the possible values is relatively small, $|S| = 2^{16}$, and thus reasonable to brute force. Add in the fact that we know that $t_i$ is the x coordinate of a point on the elliptic curve and the size of $S$ is reduced massively, to only a handful of possible points. This was also pointed out at that time \cite{backdoor} and suggestions were made to increase the truncated bits to 128. This would make the algorithm less efficient, as it would generate fewer random bits per iteration, but even an attacker with knowledge of the backdoor key $k$ would struggle massively to find the correct seed $s_{i + 1}$ through all the possible values of $t_i$. The NSA never implemented this change though.

\subsection{Adoption and removal of the Dual EC DRBG algorithm}

Despite the many criticisms from the community, for some reason, the Dual EC DRBG algorithm was adopted by some corporations like RSA Security and Microsoft. RSA Security even made it the default PRNG in their BSAFE cryptographic library. This was a very controversial move as the algorithm was not only slower than other known algorithms, but had been known to be potentially vulnerable \cite{dual-ec-drbg-backdoor}.
\\

Years later, in 2014 when Snowden leaked many classified documents from the NSA, it was revealed that the NSA most likely had knowledge of the backdoor in the Dual EC DRBG and intentionally placed it there. To push for its adoption, it was even leaked that they paid RSA Security 10 million dollars to make it the default PRNG in their BSAFE library. This revelation caused a massive uproar in the cryptographic community and many companies immediately removed the algorithm from their products. NIST also removed the algorithm from the SP 800-90 standard and advised against its use. The NSA has never confirmed nor denied the existence of the backdoor, but the evidence is overwhelming that it was intentional.
\\

After these events, the NSA had completely lost the trust of the scientific community and even now, any attempts to create new cryptographic standards are met with skepticism and scrutiny.